from copy import deepcopy

class Solution:
    def solveNQueens(self, n: int) -> List[List[str]]:
        result = []
        check_move = set()
        for i in range(n):
            self.backtrack(n, 0, i, [], check_move.copy(), result)
        return result
        
    def backtrack(self, n, x, y, config, check_move, result):
        if not self.can_move(x, y, check_move):
            return
        
        self.fill(x, y, check_move)
        queen_position = ''.join(['.' if i != y else 'Q' for i in range(n)])
        config.append(queen_position)
        
        if len(config) == n:
            result.append(config.copy())
            return
        
        for i in range(n):
            self.backtrack(n, x + 1, i, config.copy(), check_move.copy(), result)
             
    def can_move(self, x, y, check_move) -> bool:
        if y in check_move or (x - y) in check_move or (x + y) in check_move:
            return False
        return True
    
    def fill(self, x, y, check_move):
        check_move.add(y)
        check_move.add(x - y)
        check_move.add(x + y)
